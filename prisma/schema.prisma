

generator client {
  provider = "prisma-client-js"

}

datasource db {
  provider = "postgresql"
 
}
enum Role {
  STUDENT
  TUTOR
  ADMIN
}


enum UserStatus {
  ACTIVE
  BANNED
  SUSPENDED
}


model User {
  id            String    @id
  name          String
  email         String
  emailVerified Boolean   @default(false)
  image         String?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  sessions      Session[]
  accounts      Account[]


  role          Role   @default(STUDENT)
  profile_image String?
  isActive      Boolean? @default(true)
  phone         String?
  status        UserStatus @default(ACTIVE)


  tutorProfile TutorProfile?
  bookings Bookings[]


  @@unique([email])
  @@map("user")
  @@index([email])
  @@index([role])
}


model Session {
  id        String   @id
  expiresAt DateTime
  token     String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  ipAddress String?
  userAgent String?
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)


  @@unique([token])
  @@index([userId])
  @@map("session")
}


model Account {
  id                    String    @id
  accountId             String
  providerId            String
  userId                String
  user                  User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  accessToken           String?
  refreshToken          String?
  idToken               String?
  accessTokenExpiresAt  DateTime?
  refreshTokenExpiresAt DateTime?
  scope                 String?
  password              String?
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt


 


  @@index([userId])
  @@map("account")
}


model Verification {
  id         String   @id
  identifier String
  value      String
  expiresAt  DateTime
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt


  @@index([identifier])
  @@map("verification")
}






enum Days {
    MONDAY
    TUESDAY
    WEDNESDAY
    THURSDAY
    FRIDAY
    SATURDAY
    SUNDAY
}


model Availability {
    id String @id @default(uuid())
    tutorId String
    tutor TutorProfile @relation(fields: [tutorId],references: [id],onDelete: Cascade)
    day Days
    startTime DateTime
    endTime DateTime
    isBooked Boolean @default(false)
    created_at DateTime @default(now())


    @@index([tutorId])
}




enum Status {
    CONFIRMED
    COMPLETED
    CANCELLED
}


model Bookings {
    id String @id @default(uuid())
    studentId String
    student User @relation(fields: [studentId],references: [id])
    tutorId String
    tutor TutorProfile @relation(fields: [tutorId],references: [id],onDelete: Cascade)
    booking_date DateTime @default(now())
    start_time DateTime
    end_time DateTime
    duration Int @default(0)
    total_price Decimal @default(0)
    status Status @default(CONFIRMED)
    created_at DateTime @default(now())
    updated_at DateTime @updatedAt


    review Reviews?
   
}


model  Category {
    id String @id @default(uuid())
    name String @unique @db.VarChar(100)
    description String? @db.Text
    created_at DateTime @default(now())
    tutors TutorProfile[]
    @@index([name])
}


model Reviews {
    id String @id @default(uuid())
    bookingId String @unique
    booking Bookings @relation(fields: [bookingId],references: [id],onDelete: Cascade)
    rating Int
    comment String?
    created_at DateTime @default(now())
}




model TutorProfile {
    id String  @id @default(uuid())
    userId String @unique
    user User @relation(fields: [userId],references: [id],onDelete: Cascade)
    categoryId String
    category Category @relation(fields: [categoryId],references: [id])
    bio String? @db.VarChar(250)
    hourly_rate Decimal @default(0)
    subjects String[] @default([])
    total_session_completed Int @default(0)
    languages String[] @default([])
    isFeatured Boolean @default(false)
    experienceYears Int @default(0)
    education String? @db.VarChar(100)
    created_at DateTime @default(now())
    updated_at DateTime @updatedAt
    availability Availability[]
    bookings Bookings[]


    @@index([userId])
    @@index([categoryId])
}










